THREEx.ArToolkitContext.baseURL="../";var renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});renderer.setClearColor(new THREE.Color("lightgrey"),0);renderer.setSize(640,480);renderer.domElement.style.position="absolute";renderer.domElement.style.top="0px";renderer.domElement.style.left="0px";document.body.appendChild(renderer.domElement);var onRenderFcts=[];var scene=new THREE.Scene();var camera=new THREE.PerspectiveCamera(75,renderer.domElement.offsetWidth/renderer.domElement.offsetHeight,0.1,1000000);camera.position.set(0,0,10);scene.add(camera);var arToolkitSource=new THREEx.ArToolkitSource({sourceType:"webcam"});arToolkitSource.init(function onReady(){onResize()});window.addEventListener("resize",function(){onResize()});function onResize(){arToolkitSource.onResize();arToolkitSource.copySizeTo(renderer.domElement);if(arToolkitContext.arController!==null){arToolkitSource.copySizeTo(arToolkitContext.arController.canvas)}}var arToolkitContext=new THREEx.ArToolkitContext({cameraParametersUrl:THREEx.ArToolkitContext.baseURL+"../data/data/camera_para.dat",detectionMode:"mono"});arToolkitContext.init(function onCompleted(){$(".back_ground").hide()});onRenderFcts.push(function(){if(arToolkitSource.ready===false){return}arToolkitContext.update(arToolkitSource.domElement)});var controls=new THREE.OrbitControls(camera,renderer.domElement);var objLoader=new THREE.OBJLoader();objLoader.load("model/parts.obj",function(a){var c=new THREE.TextureLoader().load("images/metal.jpg");c.wrapS=THREE.RepeatWrapping;c.wrapT=THREE.RepeatWrapping;var d=["images/metal.jpg","images/metal.jpg","images/metal.jpg","images/metal.jpg","images/metal.jpg","images/metal.jpg"];var e=new THREE.CubeTextureLoader().load(d);var b=new THREE.MeshPhongMaterial({color:"#ffffff",envMap:e,reflectivity:0.9,side:THREE.DoubleSide});a.children.forEach(function(f){f.material=b});scene.add(a);fitCameraLight(a);setTimeout(function(){$("#loadingContainer").hide()},800)});function fitCameraLight(f){var h=new THREE.Box3().setFromObject(f);var j=h.getSize();var i=j.x>j.y?j.x:j.y;var c=0.8;var d=(i/2/c)*2;f.position.y=-j.y/2;camera.position.set(0,0,d);camera.lookAt(new THREE.Vector3(0,0,0));controls.minDistance=j.z*0.5;controls.maxDistance=10*j.z;var e=new THREE.DirectionalLight("#ffffff",0.6);e.position.set(d,d,d);scene.add(e);var a=new THREE.DirectionalLight("#ffffff",0.3);a.position.set(-d,d,-d);scene.add(a);var g=new THREE.AmbientLight("#ffffff",0.3);scene.add(g)}onRenderFcts.push(function(a){controls.update()});onRenderFcts.push(function(){renderer.render(scene,camera)});var lastTimeMsec=null;requestAnimationFrame(function animate(b){requestAnimationFrame(animate);lastTimeMsec=lastTimeMsec||b-1000/60;var a=Math.min(200,b-lastTimeMsec);lastTimeMsec=b;onRenderFcts.forEach(function(c){c(a/1000,b/1000)})});